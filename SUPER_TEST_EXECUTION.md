# 🚀 超級完整測試執行計劃

**測試日期**：2025-11-21  
**測試類型**：完整功能測試（文字 + OCR）  
**測試案例總數**：50 個（文字 28 + OCR 22）

---

## 📊 測試執行狀態

```
┌─────────────────────────────────────────┐
│                                         │
│   🧪 超級完整測試執行中                  │
│                                         │
│   文字測試：28 個案例                    │
│   OCR 測試：22 個案例                    │
│   總計：50 個測試案例                    │
│                                         │
└─────────────────────────────────────────┘
```

---

## ⚡ 測試前檢查清單

### 必須完成項目

- [ ] ✅ 服務已啟動（Docker 或本機）
- [ ] ✅ 管理員已設定
- [ ] ⚠️ LINE Bot 已加為好友
- [ ] ⚠️ 可以發送訊息給 Bot
- [ ] ⚠️ 日誌監控已開啟

### OCR 測試（選填）

- [ ] ⚠️ Google Vision API Key 已設定
- [ ] ⚠️ OCR 已啟用
- [ ] ⚠️ 測試圖片已準備

---

## 📝 階段 1：文字功能超級測試（28 個案例）

### 測試組 A：基本關鍵字偵測（5 個案例）

**執行時間**：3-5 分鐘

| # | 測試訊息 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| A1 | 我已經匯款了 | ✅ 觸發通知 |  | ⬜ |  |
| A2 | 我已經轉帳 1500 元了 | ✅ 觸發，金額 1500 |  | ⬜ |  |
| A3 | 轉帳完成，請確認 | ✅ 觸發通知 |  | ⬜ |  |
| A4 | 已轉，請查收 | ✅ 觸發通知 |  | ⬜ |  |
| A5 | ATM 轉帳完成了 | ✅ 觸發通知 |  | ⬜ |  |

**檢查點**：
- [ ] 所有訊息都觸發通知
- [ ] 管理員都收到 Flex Message
- [ ] Bot 回覆「已收到您的匯款資訊」
- [ ] 記錄檔案有新增資料

**日誌監控指令**：
```bash
./monitor-test.sh -r
```

---

### 測試組 B：金額解析測試（5 個案例）

**執行時間**：3-5 分鐘

| # | 測試訊息 | 預期金額 | 實際金額 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| B1 | 我匯款 1500 元了 | 1500 |  | ⬜ |  |
| B2 | 已轉帳 NT$2000 | 2000 |  | ⬜ |  |
| B3 | 轉帳 3000 台幣 | 3000 |  | ⬜ |  |
| B4 | 我匯了 NT 5000 | 5000 |  | ⬜ |  |
| B5 | ATM 轉 10000 塊 | 10000 |  | ⬜ |  |

**檢查點**：
- [ ] 所有金額都正確解析
- [ ] Flex Message 顯示正確金額
- [ ] 記錄中 amount 欄位正確

**查看記錄**：
```bash
cat src/data/remittance-records.json | jq '.[-5:] | .[] | {messageText, amount}'
```

---

### 測試組 C：延後關鍵字過濾（3 個案例）

**執行時間**：2-3 分鐘

| # | 測試訊息 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| C1 | 明天會處理匯款 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| C2 | 我稍後會轉帳 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| C3 | 等一下就去匯款 | ❌ 不觸發，延後回覆 |  | ⬜ |  |

**檢查點**：
- [ ] 管理員沒有收到通知
- [ ] Bot 回覆「👀 已收到您的訊息，完成匯款後...」
- [ ] 記錄在 remittance-intent-log.json

**查看語意過濾記錄**：
```bash
cat src/data/remittance-intent-log.json | jq '.[-3:]'
```

---

### 測試組 D：否定關鍵字過濾（3 個案例）

**執行時間**：2-3 分鐘

| # | 測試訊息 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| D1 | 我還沒匯款 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| D2 | 尚未轉帳 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| D3 | 未匯款，請問帳號 | ❌ 不觸發，延後回覆 |  | ⬜ |  |

---

### 測試組 E：詢問關鍵字過濾（3 個案例）

**執行時間**：2-3 分鐘

| # | 測試訊息 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| E1 | 請問如何匯款？ | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| E2 | 想詢問匯款帳號 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| E3 | 如何轉帳呢？ | ❌ 不觸發，延後回覆 |  | ⬜ |  |

---

### 測試組 F：疑問標記過濾（3 個案例）

**執行時間**：2-3 分鐘

| # | 測試訊息 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| F1 | 我有匯款嗎？ | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| F2 | 需要轉帳嗎 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| F3 | 匯款了？ | ❌ 不觸發，延後回覆 |  | ⬜ |  |

---

### 測試組 G：邊界案例（4 個案例）

**執行時間**：3-4 分鐘

| # | 測試訊息 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| G1 | 我已經付款了（無關鍵字） | ❌ 無回覆 |  | ⬜ |  |
| G2 | 匯款（單一關鍵字） | ✅ 觸發通知 |  | ⬜ |  |
| G3 | 我已經匯款轉帳完成 ATM（多關鍵字） | ✅ 觸發通知 |  | ⬜ |  |
| G4 | 空白匯款空白 | ✅ 觸發通知 |  | ⬜ |  |

---

### 測試組 H：管理員確認流程（2 個案例）

**執行時間**：3-5 分鐘

| # | 操作 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|-----|---------|---------|------|------|
| H1 | 發送「我已經匯款」，管理員點擊「✅ 已確認」 | 狀態更新為 confirmed |  | ⬜ |  |
| H2 | 發送「已轉帳」，管理員點擊「❌ 有誤」 | 狀態更新為 rejected |  | ⬜ |  |

**檢查記錄狀態**：
```bash
cat src/data/remittance-records.json | jq '.[] | {id, status}'
```

---

## 📊 文字測試階段總結

**完成時間**：  
**執行時長**：  
**通過案例**：__ / 28  
**失敗案例**：__ / 28  
**通過率**：__%

**發現問題**：


**備註**：


---

## 📸 階段 2：OCR 功能超級測試（22 個案例）

### ⚠️ 前置需求確認

- [ ] Google Vision API Key 已設定
- [ ] .env 中 OCR_PROVIDER=google_vision
- [ ] 服務已重啟
- [ ] 測試圖片已準備

### 測試圖片準備清單

**必備圖片**（至少 10 張）：

1. **純文字圖片**
   - [ ] 圖片 1：「我已經匯款 1500 元」
   - [ ] 圖片 2：「ATM 轉帳完成」
   - [ ] 圖片 3：「已轉帳 NT$2000」

2. **語意過濾圖片**
   - [ ] 圖片 4：「明天會匯款」
   - [ ] 圖片 5：「還沒匯款」
   - [ ] 圖片 6：「請問如何匯款？」

3. **測試圖片**
   - [ ] 圖片 7：一般圖片（無文字）
   - [ ] 圖片 8：模糊圖片
   - [ ] 圖片 9：匯款截圖（如有）
   - [ ] 圖片 10：手寫文字（如有）

---

### 測試組 I：OCR 基本功能（5 個案例）

**執行時間**：5-7 分鐘

| # | 測試圖片內容 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|------------|---------|---------|------|------|
| I1 | 「我已經匯款 1500 元」（清晰） | ✅ 辨識成功，觸發通知 |  | ⬜ |  |
| I2 | ATM 轉帳截圖 | ✅ 辨識關鍵字，觸發 |  | ⬜ |  |
| I3 | 網路銀行截圖 | ✅ 辨識關鍵字，觸發 |  | ⬜ |  |
| I4 | 手寫「已轉帳 2000 元」 | ⚠️ 可能成功 |  | ⬜ |  |
| I5 | 模糊圖片「匯款」 | ⚠️ 可能失敗 |  | ⬜ |  |

**日誌監控**：
```bash
./monitor-test.sh -o
```

**檢查 OCR 辨識文字**：
```bash
docker logs flb-attendance-system | grep "OCR 辨識文字"
```

---

### 測試組 J：OCR + 匯款關鍵字（6 個案例）

**執行時間**：6-8 分鐘

| # | 圖片內容 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| J1 | 「匯款」 | ✅ 觸發通知 |  | ⬜ |  |
| J2 | 「轉帳」 | ✅ 觸發通知 |  | ⬜ |  |
| J3 | 「轉帳完成」 | ✅ 觸發通知 |  | ⬜ |  |
| J4 | 「已轉」 | ✅ 觸發通知 |  | ⬜ |  |
| J5 | 「ATM」 | ✅ 觸發通知 |  | ⬜ |  |
| J6 | 「已經付款」（無關鍵字） | ❌ 不觸發 |  | ⬜ |  |

---

### 測試組 K：OCR + 語意過濾（4 個案例）

**執行時間**：4-5 分鐘

| # | 圖片內容 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| K1 | 「明天會匯款」 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| K2 | 「還沒匯款」 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| K3 | 「請問如何匯款？」 | ❌ 不觸發，延後回覆 |  | ⬜ |  |
| K4 | 「匯款了嗎？」 | ❌ 不觸發，延後回覆 |  | ⬜ |  |

---

### 測試組 L：混合訊息（3 個案例）

**執行時間**：3-4 分鐘

| # | 操作 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|-----|---------|---------|------|------|
| L1 | 先發文字「我已經匯款」，再發圖片「轉帳完成」 | 兩筆獨立通知 |  | ⬜ |  |
| L2 | 先發文字「附上證明」，再發圖片「已轉帳」 | 只圖片觸發 |  | ⬜ |  |
| L3 | 先發文字「我匯款了」，再發一般圖片 | 只文字觸發 |  | ⬜ |  |

---

### 測試組 M：OCR 錯誤處理（4 個案例）

**執行時間**：4-5 分鐘

| # | 測試場景 | 預期結果 | 實際結果 | 狀態 | 備註 |
|---|---------|---------|---------|------|------|
| M1 | OCR 未啟用（設定 OCR_PROVIDER=none） | 日誌：OCR 未啟用 |  | ⬜ |  |
| M2 | API Key 錯誤 | 日誌：OCR 處理失敗 |  | ⬜ |  |
| M3 | 發送極小圖片 | 系統正常處理 |  | ⬜ |  |
| M4 | 發送損毀圖片（如有） | 系統正常處理 |  | ⬜ |  |

**錯誤測試後記得恢復設定**：
```bash
# 恢復 .env
OCR_PROVIDER=google_vision
GOOGLE_VISION_API_KEY=正確的金鑰

# 重啟服務
docker-compose restart
```

---

## 📊 OCR 測試階段總結

**完成時間**：  
**執行時長**：  
**通過案例**：__ / 22  
**失敗案例**：__ / 22  
**通過率**：__%

**OCR 辨識準確度**：
- 清晰文字圖片：__ / __
- 匯款截圖：__ / __
- 手寫/模糊：__ / __

**發現問題**：


**備註**：


---

## 🎯 超級測試總結

### 整體統計

| 項目 | 數據 |
|------|------|
| 測試總時長 |  |
| 總測試案例 | 50 個 |
| 文字測試通過 | __ / 28 |
| OCR 測試通過 | __ / 22 |
| **總通過率** | **__%** |

### 功能驗證結果

| 功能模組 | 狀態 | 備註 |
|---------|------|------|
| 基本關鍵字偵測 | ⬜ 通過 / ⬜ 失敗 |  |
| 金額解析 | ⬜ 通過 / ⬜ 失敗 |  |
| 延後關鍵字過濾 | ⬜ 通過 / ⬜ 失敗 |  |
| 否定關鍵字過濾 | ⬜ 通過 / ⬜ 失敗 |  |
| 詢問關鍵字過濾 | ⬜ 通過 / ⬜ 失敗 |  |
| 疑問標記過濾 | ⬜ 通過 / ⬜ 失敗 |  |
| 管理員確認流程 | ⬜ 通過 / ⬜ 失敗 |  |
| OCR 圖片辨識 | ⬜ 通過 / ⬜ 失敗 |  |
| OCR 語意過濾 | ⬜ 通過 / ⬜ 失敗 |  |
| 錯誤處理 | ⬜ 通過 / ⬜ 失敗 |  |

### 發現的問題清單

1. 


2. 


3. 


### 改進建議

1. 


2. 


3. 


---

## 📁 測試資料備份

### 備份測試記錄

```bash
# 建立備份目錄
mkdir -p test-results/$(date +%Y%m%d)

# 備份匯款記錄
cp src/data/remittance-records.json test-results/$(date +%Y%m%d)/

# 備份語意過濾記錄
cp src/data/remittance-intent-log.json test-results/$(date +%Y%m%d)/

# 備份日誌
docker logs flb-attendance-system > test-results/$(date +%Y%m%d)/server.log
```

### 匯出測試報告

```bash
# 複製本檔案作為正式報告
cp SUPER_TEST_EXECUTION.md test-results/$(date +%Y%m%d)/TEST_REPORT.md
```

---

## ✅ 測試完成確認

- [ ] 所有 50 個測試案例已執行
- [ ] 測試結果已記錄
- [ ] 發現問題已列出
- [ ] 測試資料已備份
- [ ] 日誌已匯出
- [ ] 報告已完成

---

**測試執行者**：  
**測試完成時間**：  
**報告產生時間**：2025-11-21

---

**下一步行動**：

1. [ ] 修正發現的問題
2. [ ] 更新測試文檔
3. [ ] 提交 Git（不含 .env）
4. [ ] 部署到生產環境（如適用）
